import*as y from"path";import*as d from"../safe-buffer@5.2.1/index.js";function h(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function p(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function a(){return this instanceof a?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(a){var n=Object.getOwnPropertyDescriptor(r,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:function(){return r[a]}})}),t}var s={exports:{}},v=p(y),w=p(d);s.exports=Z;var m=s.exports.parse=I,u=v.basename,b=w.Buffer,_=/[\x00-\x20"'()*,/:;<=>?@[\\\]{}\x7f]/g,A=/%[0-9A-Fa-f]{2}/,E=/%([0-9A-Fa-f]{2})/g,c=/[^\x20-\x7e\xa0-\xff]/g,T=/\\([\u0000-\u007f])/g,$=/([\\"])/g,l=/;[\x09\x20]*([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*=[\x09\x20]*("(?:[\x20!\x23-\x5b\x5d-\x7e\x80-\xff]|\\[\x20-\x7e])*"|[!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*/g,O=/^[\x20-\x7e\x80-\xff]+$/,C=/^[!#$%&'*+.0-9A-Z^_`a-z|~-]+$/,z=/^([A-Za-z0-9!#$%&+\-^_`{}~]+)'(?:[A-Za-z]{2,3}(?:-[A-Za-z]{3}){0,3}|[A-Za-z]{4,8}|)'((?:%[0-9A-Fa-f]{2}|[A-Za-z0-9!#$&+.^_`|~-])+)$/,S=/^([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*(?:$|;)/;function Z(r,e){var t=e||{},a=t.type||"attachment",n=j(r,t.fallback);return k(new x(a,n))}function j(r,e){if(r!==void 0){var t={};if(typeof r!="string")throw new TypeError("filename must be a string");if(e===void 0&&(e=!0),typeof e!="string"&&typeof e!="boolean")throw new TypeError("fallback must be a string or boolean");if(typeof e=="string"&&c.test(e))throw new TypeError("fallback must be ISO-8859-1 string");var a=u(r),n=O.test(a),o=typeof e!="string"?e&&g(a):u(e),i=typeof o=="string"&&o!==a;return(i||!n||A.test(a))&&(t["filename*"]=a),(n||i)&&(t.filename=i?o:a),t}}function k(r){var e=r.parameters,t=r.type;if(!t||typeof t!="string"||!C.test(t))throw new TypeError("invalid type");var a=String(t).toLowerCase();if(e&&typeof e=="object")for(var n,o=Object.keys(e).sort(),i=0;i<o.length;i++){n=o[i];var f=n.substr(-1)==="*"?M(e[n]):L(e[n]);a+="; "+n+"="+f}return a}function F(r){var e=z.exec(r);if(!e)throw new TypeError("invalid extended field value");var t=e[1].toLowerCase(),a=e[2],n,o=a.replace(E,P);switch(t){case"iso-8859-1":n=g(o);break;case"utf-8":n=b.from(o,"binary").toString("utf8");break;default:throw new TypeError("unsupported charset in extended field")}return n}function g(r){return String(r).replace(c,"?")}function I(r){if(!r||typeof r!="string")throw new TypeError("argument string is required");var e=S.exec(r);if(!e)throw new TypeError("invalid type format");var t=e[0].length,a=e[1].toLowerCase(),n,o=[],i={},f;for(t=l.lastIndex=e[0].substr(-1)===";"?t-1:t;e=l.exec(r);){if(e.index!==t)throw new TypeError("invalid parameter format");if(t+=e[0].length,n=e[1].toLowerCase(),f=e[2],o.indexOf(n)!==-1)throw new TypeError("invalid duplicate parameter");if(o.push(n),n.indexOf("*")+1===n.length){n=n.slice(0,-1),f=F(f),i[n]=f;continue}typeof i[n]!="string"&&(f[0]==='"'&&(f=f.substr(1,f.length-2).replace(T,"$1")),i[n]=f)}if(t!==-1&&t!==r.length)throw new TypeError("invalid parameter format");return new x(a,i)}function P(r,e){return String.fromCharCode(parseInt(e,16))}function D(r){return"%"+String(r).charCodeAt(0).toString(16).toUpperCase()}function L(r){var e=String(r);return'"'+e.replace($,"\\$1")+'"'}function M(r){var e=String(r),t=encodeURIComponent(e).replace(_,D);return"UTF-8''"+t}function x(r,e){this.type=r,this.parameters=e}var R=s.exports,U=h(R);export{U as default,m as parse};
